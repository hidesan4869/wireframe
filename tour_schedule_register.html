<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¦‹å­¦äºˆç´„æ—¥æ™‚è¨­å®š - ä¸å‹•ç”£ãƒãƒ¼ã‚¿ãƒ«ç®¡ç†ç”»é¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f9f9f9;
            color: #2c2c2c;
        }

        .container {
            display: flex;
            height: 100vh;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: #2c2c2c;
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 1000;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-bottom: 1px solid #e0e0e0;
        }

        .header h1 {
            font-size: 20px;
            font-weight: 600;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
        .main-content {
            flex: 1;
            margin-top: 60px;
            padding: 30px;
            overflow-y: auto;
        }

        .breadcrumb {
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            border: 1px solid #e0e0e0;
            font-size: 14px;
            color: #6a6a6a;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 600;
            color: #2c2c2c;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background: #4a4a4a;
            color: white;
        }

        .btn-primary:hover {
            background: #3a3a3a;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #8a8a8a;
            color: white;
        }

        .btn-success {
            background: #6a6a6a;
            color: white;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
        }

        /* ãƒ•ã‚©ãƒ¼ãƒ  */
        .form-container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid #e0e0e0;
        }

        .form-section {
            margin-bottom: 40px;
        }

        .form-section:last-child {
            margin-bottom: 0;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #2c2c2c;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #4a4a4a;
        }

        .required {
            color: #d32f2f;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #c0c0c0;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: #6a6a6a;
            box-shadow: 0 0 0 2px rgba(106, 106, 106, 0.25);
        }

        .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #c0c0c0;
            border-radius: 6px;
            font-size: 14px;
            background: white;
        }

        /* ç‰©ä»¶æƒ…å ±ã‚«ãƒ¼ãƒ‰ */
        .property-card {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            background: #f8f8f8;
            margin-bottom: 20px;
        }

        .property-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c2c2c;
            margin-bottom: 10px;
        }

        .property-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .property-detail {
            color: #6a6a6a;
            font-size: 14px;
        }

        /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ */
        .calendar-section {
            background: #f8f8f8;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-nav {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .calendar-nav button {
            padding: 8px 12px;
            border: 1px solid #c0c0c0;
            background: white;
            border-radius: 4px;
            cursor: pointer;
        }

        .month-year {
            font-size: 18px;
            font-weight: 600;
        }

        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: #e0e0e0;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
        }

        .calendar-day-header {
            background: #f0f0f0;
            padding: 10px;
            text-align: center;
            font-weight: 600;
            color: #6a6a6a;
            font-size: 12px;
        }

        .calendar-day {
            background: white;
            padding: 8px;
            min-height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: background-color 0.2s;
        }

        .calendar-day:hover {
            background: #f0f0f0;
        }

        .calendar-day.other-month {
            background: #fafafa;
            color: #c0c0c0;
        }

        .calendar-day.unavailable {
            background: #ffebee;
            color: #d32f2f;
            text-decoration: line-through;
        }

        .calendar-day.selected {
            background: #4a4a4a;
            color: white;
        }

        .calendar-day.today {
            font-weight: 600;
            background: #e8f5e8;
        }

        /* æ™‚é–“è¨­å®š */
        .time-settings {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .time-settings h4 {
            margin-bottom: 15px;
            color: #4a4a4a;
        }

        .time-slots-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }

        .time-slot {
            padding: 8px;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background: white;
            font-size: 12px;
        }

        .time-slot:hover {
            border-color: #6a6a6a;
            background: #f0f0f0;
        }

        .time-slot.selected {
            border-color: #4a4a4a;
            background: #4a4a4a;
            color: white;
        }

        .time-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }

        /* ä¸å¯èƒ½æ—¥ãƒªã‚¹ãƒˆ */
        .unavailable-dates {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .unavailable-dates h4 {
            margin-bottom: 15px;
            color: #4a4a4a;
        }

        .date-list {
            max-height: 200px;
            overflow-y: auto;
        }

        .date-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            border-bottom: 1px solid #f0f0f0;
            background: #fafafa;
            border-radius: 4px;
            margin-bottom: 5px;
        }

        .date-item:last-child {
            border-bottom: none;
        }

        .date-remove {
            background: #d32f2f;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            cursor: pointer;
            font-size: 12px;
        }

        /* ãƒ•ã‚©ãƒ¼ãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ */
        .form-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 30px;
            border-top: 2px solid #e0e0e0;
            margin-top: 40px;
        }

        .form-actions-left {
            display: flex;
            gap: 10px;
        }

        .form-actions-right {
            display: flex;
            gap: 10px;
        }

        /* ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ */
        .form-error {
            color: #d32f2f;
            font-size: 12px;
            margin-top: 5px;
        }

        .form-input.error {
            border-color: #d32f2f;
        }

        /* é¸æŠæ—¥ã®æƒ…å ±è¡¨ç¤º */
        .selected-date-info {
            background: #e8f5e8;
            border: 1px solid #a5d6a7;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .selected-date-info h4 {
            color: #2e7d32;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <header class="header">
            <h1 style="cursor: pointer;" onclick="window.location.href='index.html'">ğŸ  ä¸å‹•ç”£ãƒãƒ¼ã‚¿ãƒ«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </h1>
            <div class="user-info">
                <span>ç”°ä¸­ å¤ªéƒã•ã‚“</span>
                <button class="btn btn-secondary">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
            </div>
        </header>

        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
        <main class="main-content">
            <div class="breadcrumb">
                <a href="index.html" style="color: #6a6a6a; text-decoration: none;">ãƒ›ãƒ¼ãƒ </a> > 
                è¦‹å­¦äºˆç´„ç®¡ç† > è¦‹å­¦äºˆç´„æ—¥æ™‚è¨­å®š
            </div>

            <div class="page-header">
                <h2 class="page-title">ğŸ“… è¦‹å­¦äºˆç´„æ—¥æ™‚è¨­å®š</h2>
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="saveDraft()">ä¸‹æ›¸ãä¿å­˜</button>
                    <button class="btn btn-secondary" onclick="copySettings()">è¨­å®šã‚³ãƒ”ãƒ¼</button>
                </div>
            </div>

            <form id="scheduleForm" class="form-container">
                <!-- ç‰©ä»¶é¸æŠ -->
                <div class="form-section">
                    <h3 class="section-title">ç‰©ä»¶é¸æŠ</h3>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">
                                ç‰©ä»¶ã‚¿ã‚¤ãƒ— <span class="required">*</span>
                            </label>
                            <select class="form-select" id="propertyType" required onchange="handlePropertyTypeChange()">
                                <option value="">ç‰©ä»¶ã‚¿ã‚¤ãƒ—ã‚’é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="house">ä½å®…ï¼ˆæ³¨æ–‡ä½å®…ãƒ»æ–°ç¯‰æˆ¸å»ºã¦ï¼‰</option>
                                <option value="land">å®…åœ°ï¼ˆåœŸåœ°ï¼‰</option>
                            </select>
                            <div class="form-error" id="propertyTypeError"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                ç‰©ä»¶å <span class="required">*</span>
                            </label>
                            <select class="form-select" id="propertyName" required onchange="loadPropertyDetails()">
                                <option value="">ã¾ãšç‰©ä»¶ã‚¿ã‚¤ãƒ—ã‚’é¸æŠã—ã¦ãã ã•ã„</option>
                            </select>
                            <div class="form-error" id="propertyNameError"></div>
                        </div>
                    </div>

                    <!-- é¸æŠã•ã‚ŒãŸç‰©ä»¶ã®è©³ç´°æƒ…å ± -->
                    <div id="propertyDetails" class="property-card" style="display: none;">
                        <div class="property-title" id="selectedPropertyTitle">ç‰©ä»¶è©³ç´°</div>
                        <div class="property-details">
                            <div class="property-detail">
                                <strong>ä½æ‰€:</strong> <span id="propertyAddress">-</span>
                            </div>
                            <div class="property-detail">
                                <strong>ä¾¡æ ¼:</strong> <span id="propertyPrice">-</span>
                            </div>
                            <div class="property-detail">
                                <strong>é¢ç©:</strong> <span id="propertyArea">-</span>
                            </div>
                            <div class="property-detail">
                                <strong>æ‹…å½“è€…:</strong> <span id="propertyStaff">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- äºˆç´„ä¸å¯æ—¥è¨­å®š -->
                <div class="form-section">
                    <h3 class="section-title">äºˆç´„ä¸å¯æ—¥è¨­å®šï¼ˆãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼‰</h3>
                    
                    <div class="calendar-section">
                        <div class="calendar-header">
                            <div class="calendar-nav">
                                <button type="button" onclick="changeMonth(-1)">â€¹ å‰æœˆ</button>
                                <span class="month-year" id="monthYear">2025å¹´9æœˆ</span>
                                <button type="button" onclick="changeMonth(1)">æ¬¡æœˆ â€º</button>
                            </div>
                            <div>
                                <small style="color: #6a6a6a;">
                                    ã‚¯ãƒªãƒƒã‚¯ã§ä¸å¯æ—¥ã‚’è¨­å®š/è§£é™¤
                                </small>
                            </div>
                        </div>

                        <div class="calendar" id="calendar">
                            <!-- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¯ JavaScript ã§å‹•çš„ã«ç”Ÿæˆ -->
                        </div>
                    </div>

                    <!-- ä¸å¯èƒ½æ—¥ãƒªã‚¹ãƒˆ -->
                    <div class="unavailable-dates">
                        <h4>è¨­å®šæ¸ˆã¿äºˆç´„ä¸å¯æ—¥</h4>
                        <div class="date-list" id="unavailableDatesList">
                            <!-- ä¸å¯èƒ½æ—¥ã¯ JavaScript ã§å‹•çš„ã«ç”Ÿæˆ -->
                        </div>
                        <div style="text-align: center; color: #7a7a7a; padding: 20px;" id="noUnavailableDates">
                            äºˆç´„ä¸å¯æ—¥ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“
                        </div>
                    </div>
                </div>

                <!-- æ—¥åˆ¥æ™‚é–“è¨­å®š -->
                <div class="form-section" id="timeSettingsSection" style="display: none;">
                    <h3 class="section-title">å¯¾å¿œå¯èƒ½æ™‚é–“è¨­å®š</h3>
                    
                    <div class="selected-date-info" id="selectedDateInfo">
                        <h4 id="selectedDateTitle">æ—¥ä»˜ã‚’é¸æŠã—ã¦ãã ã•ã„</h4>
                        <p>ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‹ã‚‰æ—¥ä»˜ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€ãã®æ—¥ã®å¯¾å¿œå¯èƒ½æ™‚é–“ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚</p>
                    </div>

                    <div class="time-settings">
                        <h4>å¯¾å¿œå¯èƒ½æ™‚é–“é¸æŠ</h4>
                        
                        <div class="time-controls">
                            <button type="button" class="btn btn-secondary btn-sm" onclick="selectAllTimeSlots()">å…¨é¸æŠ</button>
                            <button type="button" class="btn btn-secondary btn-sm" onclick="clearAllTimeSlots()">å…¨è§£é™¤</button>
                            <button type="button" class="btn btn-secondary btn-sm" onclick="selectBusinessHours()">å–¶æ¥­æ™‚é–“(9:00-18:00)</button>
                        </div>

                        <div class="time-slots-grid" id="timeSlots">
                            <!-- æ™‚é–“ã‚¹ãƒ­ãƒƒãƒˆã¯ JavaScript ã§å‹•çš„ã«ç”Ÿæˆ -->
                        </div>

                        <div style="margin-top: 15px;">
                            <button type="button" class="btn btn-success" onclick="saveTimeSettings()">
                                ã“ã®æ—¥ã®æ™‚é–“è¨­å®šã‚’ä¿å­˜
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ãƒ•ã‚©ãƒ¼ãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
                <div class="form-actions">
                    <div class="form-actions-left">
                        <button type="button" class="btn btn-secondary" onclick="window.location.href='index.html'">
                            ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="resetForm()">
                            ãƒªã‚»ãƒƒãƒˆ
                        </button>
                    </div>
                    <div class="form-actions-right">
                        <button type="button" class="btn btn-secondary" onclick="saveDraft()">
                            ä¸‹æ›¸ãä¿å­˜
                        </button>
                        <button type="submit" class="btn btn-primary">
                            è¨­å®šã‚’ä¿å­˜
                        </button>
                    </div>
                </div>
            </form>
        </main>
    </div>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let currentDate = new Date();
        let unavailableDates = new Set(); // ä¸å¯èƒ½æ—¥ã®ã‚»ãƒƒãƒˆ
        let selectedDate = null; // ç¾åœ¨é¸æŠä¸­ã®æ—¥ä»˜
        let timeSettings = {}; // æ—¥ä»˜ã”ã¨ã®æ™‚é–“è¨­å®š

        // ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯ API ã‹ã‚‰å–å¾—ï¼‰
        const propertyData = {
            house: [
                {
                    id: 'H001',
                    name: 'ãƒ¢ãƒ€ãƒ³ãƒã‚¦ã‚¹æ–°å®¿',
                    address: 'æ±äº¬éƒ½æ–°å®¿åŒºè¥¿æ–°å®¿1-1-1',
                    price: '4,800ä¸‡å††',
                    area: 'å»¶åºŠé¢ç©ï¼š120ã¡',
                    staff: 'ç”°ä¸­ å¤ªéƒ'
                },
                {
                    id: 'H002', 
                    name: 'ã‚¨ã‚³ãƒã‚¦ã‚¹æ¸‹è°·',
                    address: 'æ±äº¬éƒ½æ¸‹è°·åŒºæ¸‹è°·2-2-2',
                    price: '5,200ä¸‡å††',
                    area: 'å»¶åºŠé¢ç©ï¼š135ã¡',
                    staff: 'ä½è—¤ èŠ±å­'
                }
            ],
            land: [
                {
                    id: 'L001',
                    name: 'æ–°å®¿é§…å‰åœŸåœ°',
                    address: 'æ±äº¬éƒ½æ–°å®¿åŒºæ–°å®¿4-4-4',
                    price: '3,500ä¸‡å††',
                    area: 'åœŸåœ°é¢ç©ï¼š80ã¡',
                    staff: 'éˆ´æœ¨ ä¸€éƒ'
                },
                {
                    id: 'L002',
                    name: 'ä¸–ç”°è°·ä½å®…ç”¨åœ°',
                    address: 'æ±äº¬éƒ½ä¸–ç”°è°·åŒºä¸–ç”°è°·5-5-5',
                    price: '4,800ä¸‡å††',
                    area: 'åœŸåœ°é¢ç©ï¼š120ã¡',
                    staff: 'ç”°ä¸­ å¤ªéƒ'
                }
            ]
        };

        // ç‰©ä»¶ã‚¿ã‚¤ãƒ—å¤‰æ›´æ™‚ã®å‡¦ç†
        function handlePropertyTypeChange() {
            const propertyType = document.getElementById('propertyType').value;
            const propertyNameSelect = document.getElementById('propertyName');
            
            // ç‰©ä»¶åé¸æŠè‚¢ã‚’ã‚¯ãƒªã‚¢
            propertyNameSelect.innerHTML = '<option value="">ç‰©ä»¶ã‚’é¸æŠã—ã¦ãã ã•ã„</option>';
            
            if (propertyType && propertyData[propertyType]) {
                const properties = propertyData[propertyType];
                properties.forEach(property => {
                    const option = document.createElement('option');
                    option.value = property.id;
                    option.textContent = property.name;
                    propertyNameSelect.appendChild(option);
                });
            } else {
                propertyNameSelect.innerHTML = '<option value="">ã¾ãšç‰©ä»¶ã‚¿ã‚¤ãƒ—ã‚’é¸æŠã—ã¦ãã ã•ã„</option>';
            }

            // ç‰©ä»¶è©³ç´°ã‚’éè¡¨ç¤º
            document.getElementById('propertyDetails').style.display = 'none';
        }

        // ç‰©ä»¶è©³ç´°ã®èª­ã¿è¾¼ã¿
        function loadPropertyDetails() {
            const propertyId = document.getElementById('propertyName').value;
            const propertyType = document.getElementById('propertyType').value;
            const propertyDetails = document.getElementById('propertyDetails');
            
            if (propertyId && propertyType && propertyData[propertyType]) {
                const property = propertyData[propertyType].find(p => p.id === propertyId);
                if (property) {
                    document.getElementById('selectedPropertyTitle').textContent = property.name;
                    document.getElementById('propertyAddress').textContent = property.address;
                    document.getElementById('propertyPrice').textContent = property.price;
                    document.getElementById('propertyArea').textContent = property.area;
                    document.getElementById('propertyStaff').textContent = property.staff;
                    
                    propertyDetails.style.display = 'block';
                    
                    // æ—¢å­˜ã®è¨­å®šã‚’èª­ã¿è¾¼ã¿
                    loadExistingSettings(propertyId);
                }
            } else {
                propertyDetails.style.display = 'none';
            }
        }

        // æ—¢å­˜è¨­å®šã®èª­ã¿è¾¼ã¿
        function loadExistingSettings(propertyId) {
            // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ API ã‹ã‚‰æ—¢å­˜è¨­å®šã‚’å–å¾—
            console.log('Loading existing settings for property:', propertyId);
            
            // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
            unavailableDates.clear();
            unavailableDates.add('2025-09-15');
            unavailableDates.add('2025-09-22');
            
            timeSettings = {
                '2025-09-05': ['09:00', '10:00', '14:00', '15:00'],
                '2025-09-12': ['10:00', '11:00', '13:00', '14:00', '15:00']
            };
            
            updateCalendar();
            updateUnavailableDatesList();
        }

        // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®æœˆå¤‰æ›´
        function changeMonth(direction) {
            currentDate.setMonth(currentDate.getMonth() + direction);
            updateCalendar();
        }

        // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®æ›´æ–°
        function updateCalendar() {
            const calendar = document.getElementById('calendar');
            const monthYear = document.getElementById('monthYear');
            
            // æœˆå¹´è¡¨ç¤ºã‚’æ›´æ–°
            monthYear.textContent = `${currentDate.getFullYear()}å¹´${currentDate.getMonth() + 1}æœˆ`;
            
            // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’ã‚¯ãƒªã‚¢
            calendar.innerHTML = '';
            
            // æ›œæ—¥ãƒ˜ãƒƒãƒ€ãƒ¼
            const dayHeaders = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
            dayHeaders.forEach(day => {
                const headerElement = document.createElement('div');
                headerElement.className = 'calendar-day-header';
                headerElement.textContent = day;
                calendar.appendChild(headerElement);
            });
            
            // æœˆã®æœ€åˆã®æ—¥ã¨æœ€å¾Œã®æ—¥
            const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
            const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
            
            // å‰æœˆã®æ—¥æ•°ã‚’åŸ‹ã‚ã‚‹
            const startDay = firstDay.getDay();
            for (let i = startDay - 1; i >= 0; i--) {
                const date = new Date(firstDay);
                date.setDate(date.getDate() - (i + 1));
                const dayElement = createDayElement(date, true);
                calendar.appendChild(dayElement);
            }
            
            // ä»Šæœˆã®æ—¥
            for (let day = 1; day <= lastDay.getDate(); day++) {
                const date = new Date(currentDate.getFullYear(), currentDate.getMonth(), day);
                const dayElement = createDayElement(date, false);
                calendar.appendChild(dayElement);
            }
            
            // æ¬¡æœˆã®æ—¥æ•°ã‚’åŸ‹ã‚ã‚‹ï¼ˆ42ãƒã‚¹å®Œæˆã¾ã§ï¼‰
            const totalCells = 42; // 6é€±é–“
            const currentCells = startDay + lastDay.getDate();
            const remainingCells = totalCells - currentCells;
            
            for (let day = 1; day <= remainingCells; day++) {
                const date = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, day);
                const dayElement = createDayElement(date, true);
                calendar.appendChild(dayElement);
            }
        }

        // æ—¥ä»˜è¦ç´ ã®ä½œæˆ
        function createDayElement(date, isOtherMonth) {
            const dayElement = document.createElement('div');
            dayElement.className = 'calendar-day';
            dayElement.textContent = date.getDate();
            
            const dateString = formatDate(date);
            const today = formatDate(new Date());
            
            if (isOtherMonth) {
                dayElement.classList.add('other-month');
            }
            
            if (dateString === today) {
                dayElement.classList.add('today');
            }
            
            if (unavailableDates.has(dateString)) {
                dayElement.classList.add('unavailable');
            }
            
            if (selectedDate === dateString) {
                dayElement.classList.add('selected');
            }
            
            // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
            dayElement.addEventListener('click', () => {
                if (!isOtherMonth) {
                    selectDate(date);
                }
            });
            
            return dayElement;
        }

        // æ—¥ä»˜é¸æŠ
        function selectDate(date) {
            const dateString = formatDate(date);
            
            // ä¸å¯èƒ½æ—¥ã®åˆ‡ã‚Šæ›¿ãˆï¼ˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ä¸Šã§ã®è¨­å®šï¼‰
            if (event.ctrlKey || event.metaKey) {
                if (unavailableDates.has(dateString)) {
                    unavailableDates.delete(dateString);
                } else {
                    unavailableDates.add(dateString);
                }
                updateCalendar();
                updateUnavailableDatesList();
                return;
            }
            
            // æ™‚é–“è¨­å®šã®ãŸã‚ã®æ—¥ä»˜é¸æŠ
            selectedDate = dateString;
            updateCalendar();
            
            // æ™‚é–“è¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¡¨ç¤º
            document.getElementById('timeSettingsSection').style.display = 'block';
            document.getElementById('selectedDateTitle').textContent = `${date.getFullYear()}å¹´${date.getMonth() + 1}æœˆ${date.getDate()}æ—¥ã®æ™‚é–“è¨­å®š`;
            
            // æ—¢å­˜ã®æ™‚é–“è¨­å®šã‚’èª­ã¿è¾¼ã¿
            loadTimeSettings(dateString);
        }

        // æ™‚é–“è¨­å®šã®èª­ã¿è¾¼ã¿
        function loadTimeSettings(dateString) {
            const timeSlotsContainer = document.getElementById('timeSlots');
            timeSlotsContainer.innerHTML = '';
            
            // 15åˆ†å˜ä½ã®æ™‚é–“ã‚¹ãƒ­ãƒƒãƒˆã‚’ç”Ÿæˆï¼ˆ7:00-21:00ï¼‰
            const timeSlots = [];
            for (let hour = 7; hour < 21; hour++) {
                for (let minute = 0; minute < 60; minute += 15) {
                    const timeString = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                    timeSlots.push(timeString);
                }
            }
            
            const savedTimes = timeSettings[dateString] || [];
            
            timeSlots.forEach(time => {
                const slotElement = document.createElement('div');
                slotElement.className = 'time-slot';
                slotElement.textContent = time;
                slotElement.dataset.time = time;
                
                if (savedTimes.includes(time)) {
                    slotElement.classList.add('selected');
                }
                
                slotElement.addEventListener('click', function() {
                    this.classList.toggle('selected');
                });
                
                timeSlotsContainer.appendChild(slotElement);
            });
        }

        // æ™‚é–“è¨­å®šã®ä¿å­˜
        function saveTimeSettings() {
            if (!selectedDate) {
                alert('æ—¥ä»˜ã‚’é¸æŠã—ã¦ãã ã•ã„');
                return;
            }
            
            const selectedTimeSlots = document.querySelectorAll('.time-slot.selected');
            const times = Array.from(selectedTimeSlots).map(slot => slot.dataset.time);
            
            if (times.length === 0) {
                if (confirm('é¸æŠã•ã‚ŒãŸæ™‚é–“ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã“ã®æ—¥ã‚’å¯¾å¿œä¸å¯ã«ã—ã¾ã™ã‹ï¼Ÿ')) {
                    delete timeSettings[selectedDate];
                    unavailableDates.add(selectedDate);
                }
            } else {
                timeSettings[selectedDate] = times;
                // å¯¾å¿œå¯èƒ½æ™‚é–“ãŒè¨­å®šã•ã‚ŒãŸã®ã§ä¸å¯èƒ½æ—¥ã‹ã‚‰é™¤å¤–
                unavailableDates.delete(selectedDate);
            }
            
            updateCalendar();
            updateUnavailableDatesList();
            alert('æ™‚é–“è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ');
        }

        // æ™‚é–“ã‚¹ãƒ­ãƒƒãƒˆæ“ä½œ
        function selectAllTimeSlots() {
            document.querySelectorAll('.time-slot').forEach(slot => {
                slot.classList.add('selected');
            });
        }

        function clearAllTimeSlots() {
            document.querySelectorAll('.time-slot').forEach(slot => {
                slot.classList.remove('selected');
            });
        }

        function selectBusinessHours() {
            clearAllTimeSlots();
            document.querySelectorAll('.time-slot').forEach(slot => {
                const time = slot.dataset.time;
                const hour = parseInt(time.split(':')[0]);
                if (hour >= 9 && hour < 18) {
                    slot.classList.add('selected');
                }
            });
        }

        // ä¸å¯èƒ½æ—¥ãƒªã‚¹ãƒˆã®æ›´æ–°
        function updateUnavailableDatesList() {
            const listContainer = document.getElementById('unavailableDatesList');
            const noUnavailableDates = document.getElementById('noUnavailableDates');
            
            if (unavailableDates.size === 0) {
                listContainer.style.display = 'none';
                noUnavailableDates.style.display = 'block';
                return;
            }
            
            listContainer.style.display = 'block';
            noUnavailableDates.style.display = 'none';
            listContainer.innerHTML = '';
            
            const sortedDates = Array.from(unavailableDates).sort();
            sortedDates.forEach(dateString => {
                const dateItem = document.createElement('div');
                dateItem.className = 'date-item';
                
                const dateDisplay = new Date(dateString).toLocaleDateString('ja-JP', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    weekday: 'short'
                });
                
                dateItem.innerHTML = `
                    <span>${dateDisplay}</span>
                    <button type="button" class="date-remove" onclick="removeUnavailableDate('${dateString}')">
                        å‰Šé™¤
                    </button>
                `;
                
                listContainer.appendChild(dateItem);
            });
        }

        // ä¸å¯èƒ½æ—¥ã®å‰Šé™¤
        function removeUnavailableDate(dateString) {
            unavailableDates.delete(dateString);
            updateCalendar();
            updateUnavailableDatesList();
        }

        // æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
        function formatDate(date) {
            return date.getFullYear() + '-' + 
                   String(date.getMonth() + 1).padStart(2, '0') + '-' + 
                   String(date.getDate()).padStart(2, '0');
        }

        // ä¸‹æ›¸ãä¿å­˜
        function saveDraft() {
            console.log('Saving draft...');
            alert('ä¸‹æ›¸ãã‚’ä¿å­˜ã—ã¾ã—ãŸ');
        }

        // è¨­å®šã‚³ãƒ”ãƒ¼
        function copySettings() {
            const propertyId = document.getElementById('propertyName').value;
            if (!propertyId) {
                alert('ã¾ãšç‰©ä»¶ã‚’é¸æŠã—ã¦ãã ã•ã„');
                return;
            }
            
            // ä»–ã®ç‰©ä»¶é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼ˆç°¡ç•¥åŒ–ï¼‰
            const targetProperty = prompt('è¨­å®šã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ç‰©ä»¶IDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
            if (targetProperty) {
                console.log(`Copying settings from ${propertyId} to ${targetProperty}`);
                alert('è¨­å®šã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
            }
        }

        // ãƒ•ã‚©ãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ
        function resetForm() {
            if (confirm('ã™ã¹ã¦ã®è¨­å®šã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ')) {
                document.getElementById('scheduleForm').reset();
                unavailableDates.clear();
                timeSettings = {};
                selectedDate = null;
                document.getElementById('propertyDetails').style.display = 'none';
                document.getElementById('timeSettingsSection').style.display = 'none';
                updateCalendar();
                updateUnavailableDatesList();
            }
        }

        // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
        document.getElementById('scheduleForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const propertyId = document.getElementById('propertyName').value;
            if (!propertyId) {
                alert('ç‰©ä»¶ã‚’é¸æŠã—ã¦ãã ã•ã„');
                return;
            }
            
            if (confirm('è¦‹å­¦äºˆç´„æ—¥æ™‚è¨­å®šã‚’ä¿å­˜ã—ã¾ã™ã‹ï¼Ÿ')) {
                const data = {
                    propertyId: propertyId,
                    unavailableDates: Array.from(unavailableDates),
                    timeSettings: timeSettings
                };
                
                console.log('Saving schedule settings:', data);
                alert('è¦‹å­¦äºˆç´„æ—¥æ™‚è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ');
                
                // æˆåŠŸæ™‚ã¯ä¸€è¦§ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
                window.location.href = 'index.html';
            }
        });

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updateCalendar();
            updateUnavailableDatesList();
            
            // Ctrl/Cmdã‚­ãƒ¼ã®ãƒ’ãƒ³ãƒˆè¡¨ç¤º
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey || e.metaKey) {
                    document.querySelectorAll('.calendar-day:not(.other-month)').forEach(day => {
                        day.style.cursor = 'crosshair';
                    });
                }
            });
            
            document.addEventListener('keyup', function(e) {
                if (!e.ctrlKey && !e.metaKey) {
                    document.querySelectorAll('.calendar-day').forEach(day => {
                        day.style.cursor = 'pointer';
                    });
                }
            });
        });
    </script>
</body>
</html>