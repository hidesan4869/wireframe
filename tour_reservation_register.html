<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¦‹å­¦äºˆç´„ç™»éŒ² - ä¸å‹•ç”£ãƒãƒ¼ã‚¿ãƒ«ç®¡ç†ç”»é¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f9f9f9;
            color: #2c2c2c;
        }

        .container {
            display: flex;
            height: 100vh;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: #2c2c2c;
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 1000;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-bottom: 1px solid #e0e0e0;
        }

        .header h1 {
            font-size: 20px;
            font-weight: 600;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
        .main-content {
            flex: 1;
            margin-top: 60px;
            padding: 30px;
            overflow-y: auto;
        }

        .breadcrumb {
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            border: 1px solid #e0e0e0;
            font-size: 14px;
            color: #6a6a6a;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 600;
            color: #2c2c2c;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background: #4a4a4a;
            color: white;
        }

        .btn-primary:hover {
            background: #3a3a3a;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #8a8a8a;
            color: white;
        }

        /* ãƒ•ã‚©ãƒ¼ãƒ  */
        .form-container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid #e0e0e0;
        }

        .form-section {
            margin-bottom: 40px;
        }

        .form-section:last-child {
            margin-bottom: 0;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #2c2c2c;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #4a4a4a;
        }

        .required {
            color: #d32f2f;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #c0c0c0;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: #6a6a6a;
            box-shadow: 0 0 0 2px rgba(106, 106, 106, 0.25);
        }

        .form-textarea {
            height: 120px;
            resize: vertical;
        }

        .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #c0c0c0;
            border-radius: 6px;
            font-size: 14px;
            background: white;
        }

        .form-radio {
            display: flex;
            gap: 20px;
            align-items: center;
            margin-top: 10px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .radio-option input[type="radio"] {
            width: 18px;
            height: 18px;
        }

        /* æ—¥æ™‚é¸æŠ */
        .datetime-section {
            background: #f8f8f8;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .time-slots {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .time-slot {
            padding: 10px;
            border: 2px solid #c0c0c0;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background: white;
        }

        .time-slot:hover {
            border-color: #6a6a6a;
            background: #f0f0f0;
        }

        .time-slot.selected {
            border-color: #4a4a4a;
            background: #4a4a4a;
            color: white;
        }

        .time-slot.unavailable {
            background: #f0f0f0;
            color: #7a7a7a;
            cursor: not-allowed;
            border-color: #e0e0e0;
        }

        /* ä½æ‰€æ¤œç´¢ */
        .address-search {
            display: flex;
            gap: 10px;
            align-items: end;
        }

        .address-search .form-input {
            flex: 1;
        }

        .search-btn {
            padding: 12px 16px;
            background: #6a6a6a;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            white-space: nowrap;
        }

        /* ç‰©ä»¶æƒ…å ±ã‚«ãƒ¼ãƒ‰ */
        .property-card {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            background: #f8f8f8;
            margin-bottom: 20px;
        }

        .property-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c2c2c;
            margin-bottom: 10px;
        }

        .property-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .property-detail {
            color: #6a6a6a;
            font-size: 14px;
        }

        /* ãƒ•ã‚©ãƒ¼ãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ */
        .form-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 30px;
            border-top: 2px solid #e0e0e0;
            margin-top: 40px;
        }

        .form-actions-left {
            display: flex;
            gap: 10px;
        }

        .form-actions-right {
            display: flex;
            gap: 10px;
        }

        /* ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ */
        .form-error {
            color: #d32f2f;
            font-size: 12px;
            margin-top: 5px;
        }

        .form-input.error {
            border-color: #d32f2f;
        }

        .form-input.error:focus {
            box-shadow: 0 0 0 2px rgba(211, 47, 47, 0.25);
        }

        /* ç¢ºèªç”»é¢ */
        .confirmation-section {
            background: #f8f8f8;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .confirm-grid {
            display: grid;
            grid-template-columns: 150px 1fr;
            gap: 15px;
            margin-bottom: 10px;
        }

        .confirm-label {
            font-weight: 600;
            color: #6a6a6a;
        }

        .confirm-value {
            color: #2c2c2c;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <header class="header">
            <h1 style="cursor: pointer;" onclick="window.location.href='index.html'">ğŸ  ä¸å‹•ç”£ãƒãƒ¼ã‚¿ãƒ«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </h1>
            <div class="user-info">
                <span>ç”°ä¸­ å¤ªéƒã•ã‚“</span>
                <button class="btn btn-secondary">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
            </div>
        </header>

        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
        <main class="main-content">
            <div class="breadcrumb">
                <a href="index.html" style="color: #6a6a6a; text-decoration: none;">ãƒ›ãƒ¼ãƒ </a> > 
                è¦‹å­¦äºˆç´„ç®¡ç† > è¦‹å­¦äºˆç´„ç™»éŒ²
            </div>

            <div class="page-header">
                <h2 class="page-title">ğŸ‘ï¸ è¦‹å­¦äºˆç´„ç™»éŒ²</h2>
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="saveDraft()">ä¸‹æ›¸ãä¿å­˜</button>
                    <button class="btn btn-secondary" onclick="previewReservation()">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                </div>
            </div>

            <form id="tourReservationForm" class="form-container">
                <!-- ç‰©ä»¶é¸æŠ -->
                <div class="form-section">
                    <h3 class="section-title">ç‰©ä»¶æƒ…å ±</h3>
                    
                    <div class="form-group">
                        <label class="form-label">
                            ç‰©ä»¶ã‚¿ã‚¤ãƒ— <span class="required">*</span>
                        </label>
                        <select class="form-select" id="propertyType" required onchange="handlePropertyTypeChange()">
                            <option value="">ç‰©ä»¶ã‚¿ã‚¤ãƒ—ã‚’é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="house">ä½å®…ï¼ˆæ³¨æ–‡ä½å®…ãƒ»æ–°ç¯‰æˆ¸å»ºã¦ï¼‰</option>
                            <option value="land">å®…åœ°ï¼ˆåœŸåœ°ï¼‰</option>
                        </select>
                        <div class="form-error" id="propertyTypeError"></div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            ä½å®…åŠã³å®…åœ°å <span class="required">*</span>
                        </label>
                        <select class="form-select" id="propertyName" required>
                            <option value="">ã¾ãšç‰©ä»¶ã‚¿ã‚¤ãƒ—ã‚’é¸æŠã—ã¦ãã ã•ã„</option>
                        </select>
                        <div class="form-error" id="propertyNameError"></div>
                    </div>

                    <!-- é¸æŠã•ã‚ŒãŸç‰©ä»¶ã®è©³ç´°æƒ…å ± -->
                    <div id="propertyDetails" class="property-card" style="display: none;">
                        <div class="property-title" id="selectedPropertyTitle">ç‰©ä»¶è©³ç´°</div>
                        <div class="property-details">
                            <div class="property-detail">
                                <strong>ä½æ‰€:</strong> <span id="propertyAddress">-</span>
                            </div>
                            <div class="property-detail">
                                <strong>ä¾¡æ ¼:</strong> <span id="propertyPrice">-</span>
                            </div>
                            <div class="property-detail">
                                <strong>é¢ç©:</strong> <span id="propertyArea">-</span>
                            </div>
                            <div class="property-detail">
                                <strong>ç¯‰å¹´æœˆ:</strong> <span id="propertyAge">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- è¦‹å­¦æ—¥æ™‚ -->
                <div class="form-section">
                    <h3 class="section-title">è¦‹å­¦æ—¥æ™‚</h3>
                    
                    <div class="datetime-section">
                        <div class="form-group">
                            <label class="form-label">
                                å¸Œæœ›è¦‹å­¦æ—¥ <span class="required">*</span>
                            </label>
                            <input type="date" class="form-input" id="tourDate" required onchange="loadAvailableTimeSlots()">
                            <div class="form-error" id="tourDateError"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                å¸Œæœ›æ™‚é–“ <span class="required">*</span>
                            </label>
                            <div class="time-slots" id="timeSlots">
                                <!-- æ™‚é–“ã‚¹ãƒ­ãƒƒãƒˆã¯æ—¥ä»˜é¸æŠå¾Œã«å‹•çš„ã«ç”Ÿæˆ -->
                            </div>
                            <input type="hidden" id="selectedTimeSlot" required>
                            <div class="form-error" id="timeSlotError"></div>
                        </div>
                    </div>
                </div>

                <!-- é›†åˆå ´æ‰€ -->
                <div class="form-section">
                    <h3 class="section-title">é›†åˆå ´æ‰€</h3>
                    
                    <div class="form-group">
                        <label class="form-label">
                            é›†åˆå ´æ‰€ <span class="required">*</span>
                        </label>
                        <select class="form-select" id="meetingPoint" required>
                            <option value="">é›†åˆå ´æ‰€ã‚’é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="property">ç¾åœ°ï¼ˆç‰©ä»¶å‰ï¼‰</option>
                            <option value="station">æœ€å¯„ã‚Šé§…</option>
                            <option value="office">å–¶æ¥­æ‰€</option>
                            <option value="other">ãã®ä»–</option>
                        </select>
                        <div class="form-error" id="meetingPointError"></div>
                    </div>

                    <div class="form-group" id="otherMeetingPoint" style="display: none;">
                        <label class="form-label">é›†åˆå ´æ‰€ã®è©³ç´°</label>
                        <input type="text" class="form-input" id="meetingPointDetail" 
                               placeholder="è©³ç´°ãªé›†åˆå ´æ‰€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„">
                    </div>
                </div>

                <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ± -->
                <div class="form-section">
                    <h3 class="section-title">ãŠå®¢æ§˜æƒ…å ±</h3>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">
                                æ°åï¼ˆå§“ï¼‰ <span class="required">*</span>
                            </label>
                            <input type="text" class="form-input" id="lastName" required 
                                   placeholder="å±±ç”°">
                            <div class="form-error" id="lastNameError"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                æ°åï¼ˆåï¼‰ <span class="required">*</span>
                            </label>
                            <input type="text" class="form-input" id="firstName" required 
                                   placeholder="å¤ªéƒ">
                            <div class="form-error" id="firstNameError"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                ãƒ•ãƒªã‚¬ãƒŠï¼ˆå§“ï¼‰ <span class="required">*</span>
                            </label>
                            <input type="text" class="form-input" id="lastNameKana" required 
                                   placeholder="ãƒ¤ãƒãƒ€">
                            <div class="form-error" id="lastNameKanaError"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                ãƒ•ãƒªã‚¬ãƒŠï¼ˆåï¼‰ <span class="required">*</span>
                            </label>
                            <input type="text" class="form-input" id="firstNameKana" required 
                                   placeholder="ã‚¿ãƒ­ã‚¦">
                            <div class="form-error" id="firstNameKanaError"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ <span class="required">*</span>
                            </label>
                            <input type="email" class="form-input" id="email" required 
                                   placeholder="example@email.com">
                            <div class="form-error" id="emailError"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                é›»è©±ç•ªå· <span class="required">*</span>
                            </label>
                            <input type="tel" class="form-input" id="phone" required 
                                   placeholder="090-1234-5678">
                            <div class="form-error" id="phoneError"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">éƒµä¾¿ç•ªå·</label>
                            <div class="address-search">
                                <input type="text" class="form-input" id="zipCode" 
                                       placeholder="123-4567" pattern="[0-9]{3}-[0-9]{4}">
                                <button type="button" class="search-btn" onclick="searchAddress()">ä½æ‰€æ¤œç´¢</button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">éƒ½é“åºœçœŒ</label>
                            <select class="form-select" id="prefecture">
                                <option value="">éƒ½é“åºœçœŒã‚’é¸æŠ</option>
                                <option value="tokyo">æ±äº¬éƒ½</option>
                                <option value="kanagawa">ç¥å¥ˆå·çœŒ</option>
                                <option value="saitama">åŸ¼ç‰çœŒ</option>
                                <option value="chiba">åƒè‘‰çœŒ</option>
                                <option value="osaka">å¤§é˜ªåºœ</option>
                                <option value="kyoto">äº¬éƒ½åºœ</option>
                                <option value="other">ãã®ä»–</option>
                            </select>
                        </div>

                        <div class="form-group full-width">
                            <label class="form-label">ä½æ‰€</label>
                            <input type="text" class="form-input" id="address" 
                                   placeholder="æ–°å®¿åŒºè¥¿æ–°å®¿1-1-1 â—‹â—‹ãƒãƒ³ã‚·ãƒ§ãƒ³ 101å·å®¤">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">å‚™è€ƒ</label>
                        <textarea class="form-input form-textarea" id="remarks" 
                                  placeholder="è¦‹å­¦ã«é–¢ã™ã‚‹ã”è¦æœ›ã‚„ã”è³ªå•ãŒã‚ã‚Œã°ã”è¨˜å…¥ãã ã•ã„..."></textarea>
                    </div>
                </div>

                <!-- å£²å´äºˆå®šï¼ˆåœŸåœ°ã®å ´åˆã®ã¿è¡¨ç¤ºï¼‰ -->
                <div class="form-section" id="landSaleSection" style="display: none;">
                    <h3 class="section-title">å£²å´äºˆå®šã«ã¤ã„ã¦</h3>
                    
                    <div class="form-group">
                        <label class="form-label">
                            ç¾åœ¨ãŠä½ã¾ã„ã®ç‰©ä»¶ã®å£²å´äºˆå®šã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ <span class="required">*</span>
                        </label>
                        <div class="form-radio">
                            <div class="radio-option">
                                <input type="radio" id="saleYes" name="saleIntention" value="yes">
                                <label for="saleYes">ã¯ã„ã€å£²å´äºˆå®šãŒã‚ã‚Šã¾ã™</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="saleNo" name="saleIntention" value="no">
                                <label for="saleNo">ã„ã„ãˆã€å£²å´äºˆå®šã¯ã‚ã‚Šã¾ã›ã‚“</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="saleUndecided" name="saleIntention" value="undecided">
                                <label for="saleUndecided">ã¾ã æœªå®šã§ã™</label>
                            </div>
                        </div>
                        <div class="form-error" id="saleIntentionError"></div>
                    </div>

                    <div class="form-group" id="saleDetailsGroup" style="display: none;">
                        <label class="form-label">å£²å´äºˆå®šæ™‚æœŸ</label>
                        <select class="form-select" id="saleSchedule">
                            <option value="">å£²å´æ™‚æœŸã‚’é¸æŠ</option>
                            <option value="3months">3ãƒ¶æœˆä»¥å†…</option>
                            <option value="6months">6ãƒ¶æœˆä»¥å†…</option>
                            <option value="1year">1å¹´ä»¥å†…</option>
                            <option value="2years">2å¹´ä»¥å†…</option>
                            <option value="flexible">æ™‚æœŸã¯æŸ”è»Ÿã«å¯¾å¿œå¯èƒ½</option>
                        </select>
                    </div>
                </div>

                <!-- ãƒ•ã‚©ãƒ¼ãƒ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
                <div class="form-actions">
                    <div class="form-actions-left">
                        <button type="button" class="btn btn-secondary" onclick="window.location.href='index.html'">
                            ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="resetForm()">
                            ãƒªã‚»ãƒƒãƒˆ
                        </button>
                    </div>
                    <div class="form-actions-right">
                        <button type="button" class="btn btn-secondary" onclick="saveDraft()">
                            ä¸‹æ›¸ãä¿å­˜
                        </button>
                        <button type="submit" class="btn btn-primary">
                            è¦‹å­¦äºˆç´„ã‚’ç™»éŒ²
                        </button>
                    </div>
                </div>
            </form>
        </main>
    </div>

    <script>
        // ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯ API ã‹ã‚‰å–å¾—ï¼‰
        const propertyData = {
            house: [
                {
                    id: 'H001',
                    name: 'ãƒ¢ãƒ€ãƒ³ãƒã‚¦ã‚¹æ–°å®¿',
                    address: 'æ±äº¬éƒ½æ–°å®¿åŒºè¥¿æ–°å®¿1-1-1',
                    price: '4,800ä¸‡å††',
                    area: 'å»¶åºŠé¢ç©ï¼š120ã¡',
                    age: '2024å¹´3æœˆç¯‰'
                },
                {
                    id: 'H002', 
                    name: 'ã‚¨ã‚³ãƒã‚¦ã‚¹æ¸‹è°·',
                    address: 'æ±äº¬éƒ½æ¸‹è°·åŒºæ¸‹è°·2-2-2',
                    price: '5,200ä¸‡å††',
                    area: 'å»¶åºŠé¢ç©ï¼š135ã¡',
                    age: '2024å¹´1æœˆç¯‰'
                },
                {
                    id: 'H003',
                    name: 'ãƒ•ã‚¡ãƒŸãƒªãƒ¼ãƒã‚¦ã‚¹æ± è¢‹',
                    address: 'æ±äº¬éƒ½è±Šå³¶åŒºæ± è¢‹3-3-3',
                    price: '4,200ä¸‡å††',
                    area: 'å»¶åºŠé¢ç©ï¼š110ã¡',
                    age: '2024å¹´5æœˆç¯‰'
                }
            ],
            land: [
                {
                    id: 'L001',
                    name: 'æ–°å®¿é§…å‰åœŸåœ°',
                    address: 'æ±äº¬éƒ½æ–°å®¿åŒºæ–°å®¿4-4-4',
                    price: '3,500ä¸‡å††',
                    area: 'åœŸåœ°é¢ç©ï¼š80ã¡',
                    age: '-'
                },
                {
                    id: 'L002',
                    name: 'ä¸–ç”°è°·ä½å®…ç”¨åœ°',
                    address: 'æ±äº¬éƒ½ä¸–ç”°è°·åŒºä¸–ç”°è°·5-5-5',
                    price: '4,800ä¸‡å††',
                    area: 'åœŸåœ°é¢ç©ï¼š120ã¡',
                    age: '-'
                },
                {
                    id: 'L003',
                    name: 'ä¸­é‡åŒºç”»æ•´ç†åœ°',
                    address: 'æ±äº¬éƒ½ä¸­é‡åŒºä¸­é‡6-6-6',
                    price: '3,200ä¸‡å††',
                    area: 'åœŸåœ°é¢ç©ï¼š95ã¡',
                    age: '-'
                }
            ]
        };

        // ç‰©ä»¶ã‚¿ã‚¤ãƒ—å¤‰æ›´æ™‚ã®å‡¦ç†
        function handlePropertyTypeChange() {
            const propertyType = document.getElementById('propertyType').value;
            const propertyNameSelect = document.getElementById('propertyName');
            const landSaleSection = document.getElementById('landSaleSection');
            
            // ç‰©ä»¶åé¸æŠè‚¢ã‚’ã‚¯ãƒªã‚¢
            propertyNameSelect.innerHTML = '<option value="">ç‰©ä»¶ã‚’é¸æŠã—ã¦ãã ã•ã„</option>';
            
            if (propertyType) {
                // é¸æŠã•ã‚ŒãŸç‰©ä»¶ã‚¿ã‚¤ãƒ—ã«å¿œã˜ã¦ç‰©ä»¶ã‚’è¡¨ç¤º
                const properties = propertyData[propertyType];
                properties.forEach(property => {
                    const option = document.createElement('option');
                    option.value = property.id;
                    option.textContent = property.name;
                    propertyNameSelect.appendChild(option);
                });

                // åœŸåœ°ã®å ´åˆã¯å£²å´äºˆå®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¡¨ç¤º
                if (propertyType === 'land') {
                    landSaleSection.style.display = 'block';
                } else {
                    landSaleSection.style.display = 'none';
                }
            } else {
                propertyNameSelect.innerHTML = '<option value="">ã¾ãšç‰©ä»¶ã‚¿ã‚¤ãƒ—ã‚’é¸æŠã—ã¦ãã ã•ã„</option>';
                landSaleSection.style.display = 'none';
            }

            // ç‰©ä»¶è©³ç´°ã‚’éè¡¨ç¤º
            document.getElementById('propertyDetails').style.display = 'none';
        }

        // ç‰©ä»¶é¸æŠæ™‚ã®å‡¦ç†
        document.getElementById('propertyName').addEventListener('change', function() {
            const propertyId = this.value;
            const propertyType = document.getElementById('propertyType').value;
            const propertyDetails = document.getElementById('propertyDetails');
            
            if (propertyId && propertyType) {
                const property = propertyData[propertyType].find(p => p.id === propertyId);
                if (property) {
                    document.getElementById('selectedPropertyTitle').textContent = property.name;
                    document.getElementById('propertyAddress').textContent = property.address;
                    document.getElementById('propertyPrice').textContent = property.price;
                    document.getElementById('propertyArea').textContent = property.area;
                    document.getElementById('propertyAge').textContent = property.age;
                    
                    propertyDetails.style.display = 'block';
                }
            } else {
                propertyDetails.style.display = 'none';
            }
        });

        // åˆ©ç”¨å¯èƒ½æ™‚é–“ã‚¹ãƒ­ãƒƒãƒˆã®èª­ã¿è¾¼ã¿
        function loadAvailableTimeSlots() {
            const tourDate = document.getElementById('tourDate').value;
            const timeSlotsContainer = document.getElementById('timeSlots');
            
            if (!tourDate) {
                timeSlotsContainer.innerHTML = '';
                return;
            }

            // 15åˆ†å˜ä½ã®æ™‚é–“ã‚¹ãƒ­ãƒƒãƒˆã‚’ç”Ÿæˆï¼ˆ9:00-18:00ï¼‰
            const timeSlots = [];
            for (let hour = 9; hour < 18; hour++) {
                for (let minute = 0; minute < 60; minute += 15) {
                    const timeString = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                    timeSlots.push(timeString);
                }
            }

            // äºˆç´„æ¸ˆã¿ã®æ™‚é–“ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯ API ã‹ã‚‰å–å¾—ï¼‰
            const unavailableSlots = ['10:00', '14:30', '16:15'];

            timeSlotsContainer.innerHTML = '';
            timeSlots.forEach(time => {
                const slotElement = document.createElement('div');
                slotElement.className = 'time-slot';
                slotElement.textContent = time;
                
                if (unavailableSlots.includes(time)) {
                    slotElement.classList.add('unavailable');
                    slotElement.textContent += ' (äºˆç´„æ¸ˆ)';
                } else {
                    slotElement.addEventListener('click', function() {
                        // æ—¢é¸æŠã®æ™‚é–“ã‚¹ãƒ­ãƒƒãƒˆã‚’è§£é™¤
                        document.querySelectorAll('.time-slot').forEach(slot => {
                            slot.classList.remove('selected');
                        });
                        
                        // æ–°ã—ãé¸æŠ
                        this.classList.add('selected');
                        document.getElementById('selectedTimeSlot').value = time;
                    });
                }
                
                timeSlotsContainer.appendChild(slotElement);
            });
        }

        // é›†åˆå ´æ‰€å¤‰æ›´æ™‚ã®å‡¦ç†
        document.getElementById('meetingPoint').addEventListener('change', function() {
            const otherMeetingPoint = document.getElementById('otherMeetingPoint');
            if (this.value === 'other') {
                otherMeetingPoint.style.display = 'block';
                document.getElementById('meetingPointDetail').required = true;
            } else {
                otherMeetingPoint.style.display = 'none';
                document.getElementById('meetingPointDetail').required = false;
            }
        });

        // å£²å´äºˆå®šãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³å¤‰æ›´æ™‚ã®å‡¦ç†
        document.querySelectorAll('input[name="saleIntention"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const saleDetailsGroup = document.getElementById('saleDetailsGroup');
                if (this.value === 'yes') {
                    saleDetailsGroup.style.display = 'block';
                } else {
                    saleDetailsGroup.style.display = 'none';
                }
            });
        });

        // ä½æ‰€æ¤œç´¢
        function searchAddress() {
            const zipCode = document.getElementById('zipCode').value;
            if (zipCode) {
                // å®Ÿéš›ã®å®Ÿè£…ã§ã¯éƒµä¾¿ç•ªå· API ã‚’å‘¼ã³å‡ºã™
                console.log('Searching address for zip code:', zipCode);
                alert('ä½æ‰€æ¤œç´¢æ©Ÿèƒ½ã¯å®Ÿè£…äºˆå®šã§ã™');
            } else {
                alert('éƒµä¾¿ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
            }
        }

        // ä¸‹æ›¸ãä¿å­˜
        function saveDraft() {
            console.log('Saving draft...');
            alert('ä¸‹æ›¸ãã‚’ä¿å­˜ã—ã¾ã—ãŸ');
        }

        // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
        function previewReservation() {
            const propertyName = document.getElementById('propertyName').selectedOptions[0]?.textContent || '';
            const tourDate = document.getElementById('tourDate').value;
            const timeSlot = document.getElementById('selectedTimeSlot').value;
            const customerName = `${document.getElementById('lastName').value} ${document.getElementById('firstName').value}`;
            
            if (propertyName && tourDate && timeSlot && customerName.trim() !== ' ') {
                alert(`ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼\nç‰©ä»¶: ${propertyName}\næ—¥æ™‚: ${tourDate} ${timeSlot}\nãŠå®¢æ§˜: ${customerName}`);
            } else {
                alert('å¿…è¦ãªæƒ…å ±ã‚’å…¥åŠ›ã—ã¦ã‹ã‚‰ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ãã ã•ã„');
            }
        }

        // ãƒ•ã‚©ãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ
        function resetForm() {
            if (confirm('å…¥åŠ›å†…å®¹ã‚’ã™ã¹ã¦ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ')) {
                document.getElementById('tourReservationForm').reset();
                document.getElementById('propertyDetails').style.display = 'none';
                document.getElementById('landSaleSection').style.display = 'none';
                document.getElementById('otherMeetingPoint').style.display = 'none';
                document.getElementById('saleDetailsGroup').style.display = 'none';
                document.getElementById('timeSlots').innerHTML = '';
                document.getElementById('selectedTimeSlot').value = '';
            }
        }

        // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
        document.getElementById('tourReservationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
            if (validateForm()) {
                if (confirm('è¦‹å­¦äºˆç´„ã‚’ç™»éŒ²ã—ã¾ã™ã‹ï¼Ÿ')) {
                    console.log('Registering tour reservation...');
                    alert('è¦‹å­¦äºˆç´„ã‚’ç™»éŒ²ã—ã¾ã—ãŸ');
                    // æˆåŠŸæ™‚ã¯ä¸€è¦§ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹ï¼ˆå®Ÿè£…æ™‚ã¯é©åˆ‡ãªãƒšãƒ¼ã‚¸ã«ï¼‰
                    window.location.href = 'index.html';
                }
            }
        });

        // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
        function validateForm() {
            let isValid = true;
            const required = ['propertyType', 'propertyName', 'tourDate', 'meetingPoint', 
                            'lastName', 'firstName', 'lastNameKana', 'firstNameKana', 'email', 'phone'];
            
            // å¿…é ˆé …ç›®ãƒã‚§ãƒƒã‚¯
            required.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                const errorElement = document.getElementById(fieldId + 'Error');
                
                if (!field.value.trim()) {
                    field.classList.add('error');
                    if (errorElement) {
                        errorElement.textContent = 'ã“ã®é …ç›®ã¯å¿…é ˆã§ã™';
                    }
                    isValid = false;
                } else {
                    field.classList.remove('error');
                    if (errorElement) {
                        errorElement.textContent = '';
                    }
                }
            });

            // æ™‚é–“ã‚¹ãƒ­ãƒƒãƒˆé¸æŠãƒã‚§ãƒƒã‚¯
            const timeSlot = document.getElementById('selectedTimeSlot');
            const timeSlotError = document.getElementById('timeSlotError');
            if (!timeSlot.value) {
                timeSlotError.textContent = 'è¦‹å­¦æ™‚é–“ã‚’é¸æŠã—ã¦ãã ã•ã„';
                isValid = false;
            } else {
                timeSlotError.textContent = '';
            }

            // åœŸåœ°ã®å ´åˆã®å£²å´äºˆå®šãƒã‚§ãƒƒã‚¯
            const propertyType = document.getElementById('propertyType').value;
            if (propertyType === 'land') {
                const saleIntention = document.querySelector('input[name="saleIntention"]:checked');
                const saleError = document.getElementById('saleIntentionError');
                if (!saleIntention) {
                    saleError.textContent = 'ã“ã®é …ç›®ã¯å¿…é ˆã§ã™';
                    isValid = false;
                } else {
                    saleError.textContent = '';
                }
            }

            return isValid;
        }

        // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
        document.addEventListener('DOMContentLoaded', function() {
            const requiredFields = ['propertyType', 'propertyName', 'tourDate', 'meetingPoint',
                                  'lastName', 'firstName', 'lastNameKana', 'firstNameKana', 'email', 'phone'];
            
            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.addEventListener('blur', function() {
                        validateField(fieldId);
                    });
                }
            });
        });

        function validateField(fieldId) {
            const field = document.getElementById(fieldId);
            const errorElement = document.getElementById(fieldId + 'Error');
            
            if (!field.value.trim()) {
                field.classList.add('error');
                if (errorElement) {
                    errorElement.textContent = 'ã“ã®é …ç›®ã¯å¿…é ˆã§ã™';
                }
            } else {
                field.classList.remove('error');
                if (errorElement) {
                    errorElement.textContent = '';
                }
            }
        }
    </script>
</body>
</html>